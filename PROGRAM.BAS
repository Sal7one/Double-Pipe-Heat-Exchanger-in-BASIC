10 SIGN = -1
20 IF SIGN = 1 THEN LPRINT "PARALLEL FLOW"
30 IF SIGN = -1 THEN LPRINT "COUNTERFLOW"
40 DIM TH(100): DIM TC(100): DIM TW(100)
50 CH = 294
60 CC = 481
70 THI = 98
80 TCI = -20
90 TCO = 5
100 M = 10
110 L = 3.5
120 do = 0.01
130 p = 3.14*do
140 DX = L/M
150 HH = 7960
160 HC = 2370
170 FFH = 0
180 FFC = 0
190 U = 1/(1/HH + FFH +FCC + 1/HC)
200 TH(1) = THI
210 IF SIGN = 1 THEN TC(1) = TCI
220 IF SIGN = -1 THEN TC(1) = TCO
230 Q = 15200
240 FOR J = 1 TO M 
250 DQ = U*p*DX*(TH(J) - TC(J))
260 TH(J+1) = TH(J) - DQ/CH
270 TC(J+1) = TC(J) + SIGN*DQ/CC
280 TW(J) = TH(J) - DQ/(HH*p*DX)
290 Q = Q + DQ
300 NEXT J
310 IF SIGN = 1 GOTO 370
320 DIFF = TC(J) - TCI
330 IF DIFF > 0.01 GOTO 360
340 IF DIFF < -0.01 GOTO 360
350 GOTO 370
360 TCO = TCO - 0.5*DIFF
361 GOTO 200
370 LPRINT "    M        THO       TCO        Q    "
380 IF SIGN = 1 THEN TCO = TC(J)
390 LPRINT USING "######.##"; M, TH(J), TCO, Q
400 STOP
410 END
